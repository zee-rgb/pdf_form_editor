<%= turbo_frame_tag "overlay_elements" do %>
  <% if pdf_document.overlay_elements.present? %>
    <% pdf_document.overlay_elements.each_with_index do |element, index| %>
      <div class="absolute text-xs px-1 py-0.5 rounded draggable resizable element-overlay"
           style="left: <%= element[:x] || element['x'] %>%; top: <%= element[:y] || element['y'] %>%; min-width: 60px; min-height: 20px; z-index: 100; background-color: rgba(255, 255, 255, 0.9); border: 1px solid #ccc;"
           data-element-id="<%= index %>">
        <div class="element-content"><%= element[:content] || element['content'] %></div>
        <button onclick="this.parentElement.style.display='none'" 
                class="remove-btn absolute -top-1 -right-1 bg-red-500 text-white rounded-full w-4 h-4 text-xs hover:bg-red-600 flex items-center justify-center"
                style="font-size: 8px; display: none;">
           Ã—
        </button>
        <div class="resize-handle absolute bottom-right w-3 h-3 bg-blue-500 rounded-full opacity-50 hover:opacity-100" style="display: none;"></div>
      </div>
    <% end %>
  <% end %>
<% end %>

<style>
  .element-overlay {
    background-color: transparent;
    border: 1px dashed transparent;
    transition: all 0.2s;
    z-index: 100;
    overflow: visible;
  }
  .element-overlay:hover {
    background-color: rgba(235, 248, 255, 0.3);
    border: 1px dashed rgba(59, 130, 246, 0.5);
    box-shadow: 0 0 5px rgba(59, 130, 246, 0.3);
  }
  .element-content {
    pointer-events: none;
  }
  .resize-handle {
    right: -4px;
    bottom: -4px;
    cursor: nwse-resize;
    display: none;
    z-index: 101;
  }
  .element-overlay:hover .resize-handle {
    display: block;
  }
  .dragging {
    opacity: 0.8;
    background-color: rgba(235, 248, 255, 0.5) !important;
    border: 1px dashed rgba(59, 130, 246, 0.7) !important;
    box-shadow: 0 2px 10px rgba(59, 130, 246, 0.4);
    z-index: 200;
  }
  .resizing {
    opacity: 0.8;
    background-color: rgba(235, 248, 255, 0.5) !important;
    border: 1px dashed rgba(59, 130, 246, 0.7) !important;
    box-shadow: 0 2px 10px rgba(59, 130, 246, 0.4);
    z-index: 200;
  }
  .remove-btn {
    display: none;
    z-index: 102;
  }
  .element-overlay:hover .remove-btn {
    display: flex;
  }
</style>
